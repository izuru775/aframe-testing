<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>
    <!-- JavaScript Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <a-scene id="mainScene" crusor="rayOrigin: mouse">
      <a-plane
        position="0 0 -4"
        rotation="-90 0 0"
        width="4"
        height="4"
        color="#7BC8A4"
      ></a-plane>
      <a-sky color="white"></a-sky>
      <a-assets id="assets">
        <!--a-asset-item  id="cityModel" src="./m1887_free_fire/scene.gltf"></a-asset-item>
        <a-asset-item  id="tree" src="https://bucketbeforekicks.s3.ap-southeast-2.amazonaws.com/tree.glb"></a-asset-item -->
        <!-- <a-asset-item id="crate" src="https://oilcan.s3.ap-southeast-2.amazonaws.com/18th-century-oilan/source/OilCan.glb"></a-asset-item> -->
      </a-assets>
      <a-entity
        scale="10 10 10"
        position="1 0 -2"
        gltf-model="#tree"
      ></a-entity>

      <a-entity
        scale="10 10 10"
        position="1 1 -2"
        gltf-model="#cityModel"
      ></a-entity>
       <!-- "button" -->
    <!-- <a-entity id="refresh-button" geometry="primitive: box" material="color: red" position="0 0 -2"></a> -->
    </a-scene>
  </body>


  <script>
    $(document).ready(() => {
      let dataUrl = "http://localhost:3001/api";

      let objectArray = [];

      $.get(dataUrl, (result, err) => {
        //   console.log(result.data[0]);
        const { environmentName, environmentCreator, vrObject } =
          result.data[0];
        let { url, position, scale, rotation } = vrObject[0];

        console.log(position);

        let models = [
          { model: "gun", position: "1 1 -6 " },
          { model: "tree", position: "1 4 -5 " },
          { model: "tree", position: "2 2 -3 " },
          { model: "tree", position: "3 3 3 " },
          { model: "oilcan", position: position },
        ];

        let assets = [
          { name: "gun", url: "./m1887_free_fire/scene.gltf" },
          {
            name: "tree",
            url: "https://bucketbeforekicks.s3.ap-southeast-2.amazonaws.com/tree.glb",
          },
          {
            name: "oilcan",
            url: "https://oilcan.s3.ap-southeast-2.amazonaws.com/18th-century-oilan/source/OilCan.glb",
          },
        ];

        //load the assets dynamically
        assets.forEach((asset) => {
          let tAsset = $(
            `<a-asset-item  id="${asset.name}" src="${asset.url}"></a-asset-item>`
          );
          $("#assets").append(tAsset);
        });

        models.forEach((model) => {
          console.log(model);
          //let test=$(`<div>Hello ${model}</div>`)
          let test = $(
            `<a-entity scale="10 10 10" position="${model.position}" gltf-model="#${model.model}"></a-entity>`
          );
          $("#mainScene").append(test);
          console.log(test);
        });
        document
          .querySelector("a-entity")
          .addEventListener("click", function (evt) {
            console.log("This A-Frame entity collided with another entity!");
          });

          document.querySelector('#refresh-button').addEventListener('click', function() {
        console.log('Clicked');
    });
      });
      
    });
  </script>
</html>
